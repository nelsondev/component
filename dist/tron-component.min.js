/*!
 * Tron Component v1.0.0
 * Ultra-simple reactive web component library
 * (c) 2024 Nelson M
 * Released under the MIT License
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).TronComponent={})}(this,function(t){"use strict";var e;var n="undefined"==typeof document?void 0:document,i=!!n&&"content"in n.createElement("template"),o=!!n&&n.createRange&&"createContextualFragment"in n.createRange();function r(t){return t=t.trim(),i?function(t){var e=n.createElement("template");return e.innerHTML=t,e.content.childNodes[0]}(t):o?function(t){return e||(e=n.createRange()).selectNode(n.body),e.createContextualFragment(t).childNodes[0]}(t):function(t){var e=n.createElement("body");return e.innerHTML=t,e.childNodes[0]}(t)}function s(t,e){var n,i,o=t.nodeName,r=e.nodeName;return o===r||(n=o.charCodeAt(0),i=r.charCodeAt(0),n<=90&&i>=97?o===r.toUpperCase():i<=90&&n>=97&&r===o.toUpperCase())}function d(t,e,n){t[n]!==e[n]&&(t[n]=e[n],t[n]?t.setAttribute(n,""):t.removeAttribute(n))}var a={OPTION:function(t,e){var n=t.parentNode;if(n){var i=n.nodeName.toUpperCase();"OPTGROUP"===i&&(i=(n=n.parentNode)&&n.nodeName.toUpperCase()),"SELECT"!==i||n.hasAttribute("multiple")||(t.hasAttribute("selected")&&!e.selected&&(t.setAttribute("selected","selected"),t.removeAttribute("selected")),n.selectedIndex=-1)}d(t,e,"selected")},INPUT:function(t,e){d(t,e,"checked"),d(t,e,"disabled"),t.value!==e.value&&(t.value=e.value),e.hasAttribute("value")||t.removeAttribute("value")},TEXTAREA:function(t,e){var n=e.value;t.value!==n&&(t.value=n);var i=t.firstChild;if(i){var o=i.nodeValue;if(o==n||!n&&o==t.placeholder)return;i.nodeValue=n}},SELECT:function(t,e){if(!e.hasAttribute("multiple")){for(var n,i,o=-1,r=0,s=t.firstChild;s;)if("OPTGROUP"===(i=s.nodeName&&s.nodeName.toUpperCase()))(s=(n=s).firstChild)||(s=n.nextSibling,n=null);else{if("OPTION"===i){if(s.hasAttribute("selected")){o=r;break}r++}!(s=s.nextSibling)&&n&&(s=n.nextSibling,n=null)}t.selectedIndex=o}}};function c(){}function l(t){if(t)return t.getAttribute&&t.getAttribute("id")||t.id}var u=function(t){return function(e,i,o){if(o||(o={}),"string"==typeof i)if("#document"===e.nodeName||"HTML"===e.nodeName||"BODY"===e.nodeName){var d=i;(i=n.createElement("html")).innerHTML=d}else i=r(i);else 11===i.nodeType&&(i=i.firstElementChild);var u=o.getNodeKey||l,h=o.onBeforeNodeAdded||c,f=o.onNodeAdded||c,p=o.onBeforeElUpdated||c,v=o.onElUpdated||c,y=o.onBeforeNodeDiscarded||c,m=o.onNodeDiscarded||c,S=o.onBeforeElChildrenUpdated||c,_=o.skipFromChildren||c,b=o.addChild||function(t,e){return t.appendChild(e)},g=!0===o.childrenOnly,w=Object.create(null),C=[];function N(t){C.push(t)}function E(t,e){if(1===t.nodeType)for(var n=t.firstChild;n;){var i=void 0;e&&(i=u(n))?N(i):(m(n),n.firstChild&&E(n,e)),n=n.nextSibling}}function T(t,e,n){!1!==y(t)&&(e&&e.removeChild(t),m(t),E(t,n))}function A(t){if(1===t.nodeType||11===t.nodeType)for(var e=t.firstChild;e;){var n=u(e);n&&(w[n]=e),A(e),e=e.nextSibling}}function x(t){f(t);for(var e=t.firstChild;e;){var n=e.nextSibling,i=u(e);if(i){var o=w[i];o&&s(e,o)?(e.parentNode.replaceChild(o,e),U(o,e)):x(e)}else x(e);e=n}}function U(e,i,o){var r=u(i);if(r&&delete w[r],!o){var d=p(e,i);if(!1===d)return;if(d instanceof HTMLElement&&A(e=d),t(e,i),v(e),!1===S(e,i))return}"TEXTAREA"!==e.nodeName?function(t,e){var i,o,r,d,c,l=_(t,e),f=e.firstChild,p=t.firstChild;t:for(;f;){for(d=f.nextSibling,i=u(f);!l&&p;){if(r=p.nextSibling,f.isSameNode&&f.isSameNode(p)){f=d,p=r;continue t}o=u(p);var v=p.nodeType,y=void 0;if(v===f.nodeType&&(1===v?(i?i!==o&&((c=w[i])?r===c?y=!1:(t.insertBefore(c,p),o?N(o):T(p,t,!0),o=u(p=c)):y=!1):o&&(y=!1),(y=!1!==y&&s(p,f))&&U(p,f)):3!==v&&8!=v||(y=!0,p.nodeValue!==f.nodeValue&&(p.nodeValue=f.nodeValue))),y){f=d,p=r;continue t}o?N(o):T(p,t,!0),p=r}if(i&&(c=w[i])&&s(c,f))l||b(t,c),U(c,f);else{var m=h(f);!1!==m&&(m&&(f=m),f.actualize&&(f=f.actualize(t.ownerDocument||n)),b(t,f),x(f))}f=d,p=r}!function(t,e,n){for(;e;){var i=e.nextSibling;(n=u(e))?N(n):T(e,t,!0),e=i}}(t,p,o);var S=a[t.nodeName];S&&S(t,e)}(e,i):a.TEXTAREA(e,i)}A(e);var R,O,L=e,$=L.nodeType,I=i.nodeType;if(!g)if(1===$)1===I?s(e,i)||(m(e),L=function(t,e){for(var n=t.firstChild;n;){var i=n.nextSibling;e.appendChild(n),n=i}return e}(e,(R=i.nodeName,(O=i.namespaceURI)&&"http://www.w3.org/1999/xhtml"!==O?n.createElementNS(O,R):n.createElement(R)))):L=i;else if(3===$||8===$){if(I===$)return L.nodeValue!==i.nodeValue&&(L.nodeValue=i.nodeValue),L;L=i}if(L===i)m(e);else{if(i.isSameNode&&i.isSameNode(L))return;if(U(L,i,g),C)for(var M=0,k=C.length;M<k;M++){var H=w[C[M]];H&&T(H,H.parentNode,!1)}}return!g&&L!==e&&e.parentNode&&(L.actualize&&(L=L.actualize(e.ownerDocument||n)),e.parentNode.replaceChild(L,e)),L}}(function(t,e){var n,i,o,r,s=e.attributes;if(11!==e.nodeType&&11!==t.nodeType){for(var d=s.length-1;d>=0;d--)i=(n=s[d]).name,o=n.namespaceURI,r=n.value,o?(i=n.localName||i,t.getAttributeNS(o,i)!==r&&("xmlns"===n.prefix&&(i=n.name),t.setAttributeNS(o,i,r))):t.getAttribute(i)!==r&&t.setAttribute(i,r);for(var a=t.attributes,c=a.length-1;c>=0;c--)i=(n=a[c]).name,(o=n.namespaceURI)?(i=n.localName||i,e.hasAttributeNS(o,i)||t.removeAttributeNS(o,i)):e.hasAttribute(i)||t.removeAttribute(i)}});const h=Symbol.for("preact-signals");function f(){if(m>1)return void m--;let t,e=!1;for(;void 0!==v;){let n=v;for(v=void 0,S++;void 0!==n;){const i=n.o;if(n.o=void 0,n.f&=-3,!(8&n.f)&&C(n))try{n.c()}catch(n){e||(t=n,e=!0)}n=i}}if(S=0,m--,e)throw t}let p,v;function y(t){const e=p;p=void 0;try{return t()}finally{p=e}}let m=0,S=0,_=0;function b(t){if(void 0===p)return;let e=t.n;return void 0===e||e.t!==p?(e={i:0,S:t,p:p.s,n:void 0,t:p,e:void 0,x:void 0,r:e},void 0!==p.s&&(p.s.n=e),p.s=e,t.n=e,32&p.f&&t.S(e),e):-1===e.i?(e.i=0,void 0!==e.n&&(e.n.p=e.p,void 0!==e.p&&(e.p.n=e.n),e.p=p.s,e.n=void 0,p.s.n=e,p.s=e),e):void 0}function g(t,e){this.v=t,this.i=0,this.n=void 0,this.t=void 0,this.W=null==e?void 0:e.watched,this.Z=null==e?void 0:e.unwatched}function w(t,e){return new g(t,e)}function C(t){for(let e=t.s;void 0!==e;e=e.n)if(e.S.i!==e.i||!e.S.h()||e.S.i!==e.i)return!0;return!1}function N(t){for(let e=t.s;void 0!==e;e=e.n){const n=e.S.n;if(void 0!==n&&(e.r=n),e.S.n=e,e.i=-1,void 0===e.n){t.s=e;break}}}function E(t){let e,n=t.s;for(;void 0!==n;){const t=n.p;-1===n.i?(n.S.U(n),void 0!==t&&(t.n=n.n),void 0!==n.n&&(n.n.p=t)):e=n,n.S.n=n.r,void 0!==n.r&&(n.r=void 0),n=t}t.s=e}function T(t,e){g.call(this,void 0),this.x=t,this.s=void 0,this.g=_-1,this.f=4,this.W=null==e?void 0:e.watched,this.Z=null==e?void 0:e.unwatched}function A(t){const e=t.u;if(t.u=void 0,"function"==typeof e){m++;const n=p;p=void 0;try{e()}catch(e){throw t.f&=-2,t.f|=8,x(t),e}finally{p=n,f()}}}function x(t){for(let e=t.s;void 0!==e;e=e.n)e.S.U(e);t.x=void 0,t.s=void 0,A(t)}function U(t){if(p!==this)throw new Error("Out-of-order effect");E(this),p=t,this.f&=-2,8&this.f&&x(this),f()}function R(t){this.x=t,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}function O(t){const e=new R(t);try{e.c()}catch(t){throw e.d(),t}const n=e.d.bind(e);return n[Symbol.dispose]=n,n}function L(t){return t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}function $(t,e){if(null==t)return t;switch(e){case Boolean:return"true"===t||!0===t||""===t;case Number:const n=Number(t);return isNaN(n)?0:n;case Array:case Object:if("string"==typeof t)try{return JSON.parse(t)}catch{return e===Array?[]:{}}return t;default:return String(t)}}function I(t){return{react:e=>Array.isArray(e)?function(t,e){const n=w([...e]);return n.render=function(t){return this.value.map((e,n)=>"function"==typeof t?t(e,n):t).join("")},["push","pop","shift","unshift","splice","sort","reverse"].forEach(t=>{n[t]=function(...e){const n=[...this.value],i=n[t](...e);return this.value=n,i}}),O(()=>{n.value,t.isConnected&&t._scheduleUpdate()}),t._reactives.set(n,!0),n}(t,e):function(t,e){const n=w(e);return n.valueOf=function(){return this.value},n.toString=function(){return String(this.value)},O(()=>{n.value,t.isConnected&&t._scheduleUpdate()}),t._reactives.set(n,!0),n}(t,e),element:t,event(e,n=null){const i=n||"_evt"+t._eventCounter++;t[i]=(...t)=>e(...t);const o=e.toString();if(!/^\s*\(\s*[^)]+\s*\)/.test(o))return`this.getRootNode().host.${i}()`;return o.includes(",")?`this.getRootNode().host.${i}(event)`:`(function(e){e.preventDefault();this.getRootNode().host.${i}(e)}).call(this,event)`},props:e=>function(t,e){const n={},i={};return e.forEach(t=>{const e="string"==typeof t?{name:t,type:String,default:""}:{type:String,default:"",...t};n[e.name]=e}),t.constructor.properties=n,t.constructor.observedAttributes=Object.keys(n).map(L),Object.keys(n).forEach(e=>{const o=n[e],r=L(e);Object.defineProperty(i,e,{get(){const n=t.getAttribute(r),i=null!==n?$(n,o.type):o.default;return o.required&&null==i&&console.warn(`Required prop '${e}' is missing on ${t.tagName}`),o.validator&&!o.validator(i)&&console.warn(`Invalid prop '${e}' value:`,i),i},set(n){if(o.validator&&!o.validator(n))return void console.warn(`Invalid prop '${e}' value:`,n);const i=$(n,o.type);t.setAttribute(r,i)}})}),t._props=i,i}(t,e),computed(e){const n={_fn:e,_cache:null,_dirty:!0,get value(){return this._dirty&&(this._cache=this._fn(),this._dirty=!1),this._cache}},i=t._scheduleUpdate;return t._scheduleUpdate=function(){n._dirty=!0,i.call(this)},n},watch(e,n,i={}){let o=e.value;i.immediate&&n(e.value);const r=t._scheduleUpdate;return t._scheduleUpdate=function(){(()=>{const t=e.value;t!==o&&(n(t,o),o=t)})(),r.call(this)},()=>{t._scheduleUpdate=r}},render(e){t._template=e},onMounted(e){t.isConnected?e():t.addEventListener("mounted",e,{once:!0})},onUpdated(e){t.addEventListener("updated",e)},onBeforeUpdate(e){t.addEventListener("beforeUpdate",e)},onUnmounted(e){t.addEventListener("unmounted",e)}}}g.prototype.brand=h,g.prototype.h=function(){return!0},g.prototype.S=function(t){const e=this.t;e!==t&&void 0===t.e&&(t.x=e,this.t=t,void 0!==e?e.e=t:y(()=>{var t;null==(t=this.W)||t.call(this)}))},g.prototype.U=function(t){if(void 0!==this.t){const e=t.e,n=t.x;void 0!==e&&(e.x=n,t.e=void 0),void 0!==n&&(n.e=e,t.x=void 0),t===this.t&&(this.t=n,void 0===n&&y(()=>{var t;null==(t=this.Z)||t.call(this)}))}},g.prototype.subscribe=function(t){return O(()=>{const e=this.value,n=p;p=void 0;try{t(e)}finally{p=n}})},g.prototype.valueOf=function(){return this.value},g.prototype.toString=function(){return this.value+""},g.prototype.toJSON=function(){return this.value},g.prototype.peek=function(){const t=p;p=void 0;try{return this.value}finally{p=t}},Object.defineProperty(g.prototype,"value",{get(){const t=b(this);return void 0!==t&&(t.i=this.i),this.v},set(t){if(t!==this.v){if(S>100)throw new Error("Cycle detected");this.v=t,this.i++,_++,m++;try{for(let t=this.t;void 0!==t;t=t.x)t.t.N()}finally{f()}}}}),T.prototype=new g,T.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if(32==(36&this.f))return!0;if(this.f&=-5,this.g===_)return!0;if(this.g=_,this.f|=1,this.i>0&&!C(this))return this.f&=-2,!0;const t=p;try{N(this),p=this;const t=this.x();(16&this.f||this.v!==t||0===this.i)&&(this.v=t,this.f&=-17,this.i++)}catch(t){this.v=t,this.f|=16,this.i++}return p=t,E(this),this.f&=-2,!0},T.prototype.S=function(t){if(void 0===this.t){this.f|=36;for(let t=this.s;void 0!==t;t=t.n)t.S.S(t)}g.prototype.S.call(this,t)},T.prototype.U=function(t){if(void 0!==this.t&&(g.prototype.U.call(this,t),void 0===this.t)){this.f&=-33;for(let t=this.s;void 0!==t;t=t.n)t.S.U(t)}},T.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(let t=this.t;void 0!==t;t=t.x)t.t.N()}},Object.defineProperty(T.prototype,"value",{get(){if(1&this.f)throw new Error("Cycle detected");const t=b(this);if(this.h(),void 0!==t&&(t.i=this.i),16&this.f)throw this.v;return this.v}}),R.prototype.c=function(){const t=this.S();try{if(8&this.f)return;if(void 0===this.x)return;const t=this.x();"function"==typeof t&&(this.u=t)}finally{t()}},R.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,A(this),N(this),m++;const t=p;return p=this,U.bind(this,t)},R.prototype.N=function(){2&this.f||(this.f|=2,this.o=v,v=this)},R.prototype.d=function(){this.f|=8,1&this.f||x(this)},R.prototype.dispose=function(){this.d()};const M=new Map;const k=new class{constructor(){this.pending=new Set,this.scheduled=!1}schedule(t){this.pending.add(t),this.scheduled||(this.scheduled=!0,requestAnimationFrame(()=>this.flush()))}flush(){const t=[...this.pending];this.pending.clear(),this.scheduled=!1,t.forEach(t=>{t.isConnected&&t._render()})}};function H(t,e){if(M.has(t))return console.warn(`Component ${t} already registered`),M.get(t);class n extends HTMLElement{static properties={};constructor(){super(),this.attachShadow({mode:"open"}),this._reactives=new Map,this._eventCounter=0,this._template=null,this._lastHTML="",this._firstRender=!0,this._visible=!0,this._updateScheduled=!1;const t=I(this);e.call(t,t)}connectedCallback(){this._applyStyles(),function(t){if(!window.IntersectionObserver)return void(t._visible=!0);const e=new IntersectionObserver(e=>{t._visible=e[0].isIntersecting},{threshold:.1});e.observe(t),t._observer=e}(this),this._scheduleUpdate(),this.dispatchEvent(new CustomEvent("mounted"))}disconnectedCallback(){this._observer?.disconnect(),this._reactives.clear(),this.dispatchEvent(new CustomEvent("unmounted"))}attributeChangedCallback(t,e,n){if(e!==n&&this._props){this._kebabToCamel(t)in this._props&&this._scheduleUpdate()}}_scheduleUpdate(){!this._updateScheduled&&this.isConnected&&(this._updateScheduled=!0,k.schedule(this))}_render(){if(this._template){this._updateScheduled=!1,this.dispatchEvent(new CustomEvent("beforeUpdate"));try{const t="function"==typeof this._template?this._template():String(this._template);if(t===this._lastHTML&&!this._firstRender)return;this._firstRender?this._renderInitial(t):this._renderUpdate(t),this._lastHTML=t,this._firstRender=!1,this.dispatchEvent(new CustomEvent("updated"))}catch(e){console.error(`Error rendering ${t}:`,e)}}}_renderInitial(t){const e=this._getStyles(),n=e?`<style>${e}</style>${t}`:t;this.shadowRoot.innerHTML=n}_renderUpdate(t){const e=document.createElement("template");e.innerHTML=t,this.shadowRoot.firstElementChild&&e.content.firstElementChild?u(this.shadowRoot.firstElementChild,e.content.firstElementChild):this.shadowRoot.innerHTML=t}_applyStyles(){const t=window.__tronStyles__;t instanceof CSSStyleSheet&&this.shadowRoot.adoptedStyleSheets&&(this.shadowRoot.adoptedStyleSheets=[t])}_getStyles(){const t=window.__tronStyles__;return t&&"string"==typeof t?t:null}_kebabToCamel(t){return t.replace(/-([a-z])/g,(t,e)=>e.toUpperCase())}forceUpdate(){this._scheduleUpdate()}}return customElements.define(t,n),M.set(t,n),n}const j=new class{async init(t={}){const{stylesheets:e=[],cssText:n="",autoDetect:i=!1}=t;let o=n,r=[...e];if(i){const t=this._detectExistingStyles();o=t.css+"\n"+o,r=[...t.imports,...r]}o+=this._getBaseStyles();const s=this._combineStyles(r,o);if(this._supportsAdoptedStyleSheets()&&s)try{const t=new CSSStyleSheet;await t.replace(s),window.__tronStyles__=t}catch(t){window.__tronStyles__=s}else window.__tronStyles__=s;return this}_detectExistingStyles(){const t=[],e=[];try{Array.from(document.styleSheets).forEach(n=>{try{const e=n.cssRules||n.rules;e&&Array.from(e).forEach(e=>{e.cssText&&t.push(e.cssText)})}catch(t){n.href&&e.push(n.href)}})}catch(t){}return{css:t.join("\n"),imports:e}}_getBaseStyles(){return"\n/* Tron Component Base Styles */\n:host {\n  display: block;\n  box-sizing: border-box;\n}\n\n*, *::before, *::after {\n  box-sizing: inherit;\n}\n"}_combineStyles(t,e){const n=t.map(t=>`@import url('${t}');`).join("\n");return t.length>0?`${n}\n${e}`:e}_supportsAdoptedStyleSheets(){return"adoptedStyleSheets"in Document.prototype}};async function B(t={}){return await j.init(t),{component:P,init:B}}function P(t,e){return H(t,e)}"undefined"!=typeof window&&(window.component=P,window.TronComponent={component:P,init:B}),t.component=P,t.init=B});
